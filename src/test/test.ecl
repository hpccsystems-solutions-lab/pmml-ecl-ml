IMPORT ML_Core;
IMPORT ML_Core.Types;
IMPORT LearningTrees AS LT;

friedman1RECORD := RECORD
        Types.t_FieldNumber id;
        Types.t_FieldReal A1;
        Types.t_FieldReal A2;
        Types.t_FieldReal A3;
        Types.t_FieldReal A4;
        Types.t_FieldReal A5;
        Types.t_FieldReal A6;
        Types.t_FieldReal A7;
        Types.t_FieldReal A8;
        Types.t_FieldReal A9;
        Types.t_FieldReal A10;
        Types.t_FieldReal class;
    END;

myData := DATASET([
        {1, 0.114226913,0.569244345,0.026937481,0.263261152,0.408102906,0.374490825,0.188110139,0.283253807,0.233603091,0.414987746,12.44372094},
        {2, 0.50152658,0.177326812,0.396062212,0.376661071,0.977031906,0.032373832,0.869585738,0.926350103,0.878151247,0.79796792,11.0763073},
        {3, 0.826525829,0.566428752,0.795189599,0.968154987,0.624501336,0.624899125,0.415253251,0.291877989,0.256477134,0.98412051,27.03351472},
        {4, 0.284572269,0.969272251,0.74776444,0.421012907,0.666955508,0.031414731,0.080586383,0.023616716,0.580023143,0.511490537,14.18551586},
        {5, 0.924726527,0.684820285,0.975154664,0.060759563,0.874159883,0.728268122,0.950929056,0.50796083,0.334482926,0.759410404,14.77896872},
        {6, 0.780454113,0.472508022,0.487717438,0.586406954,0.615021248,0.997907149,0.277928171,0.849098565,0.267038569,0.554906092,18.64815082},
        {7, 0.919621345,0.635239282,0.899054495,0.829564446,0.917873923,0.201348899,0.108648976,0.979253799,0.414204347,0.02318953,25.00808288},
        {8, 0.977228743,0.268764508,0.88168592,0.175690276,0.630464325,0.395126505,0.077200256,0.460058912,0.653711524,0.116111979,18.6131861},
        {9, 0.879787818,0.082865322,0.568501489,0.485379094,0.537529585,0.773241804,0.096009213,0.664338969,0.889866671,0.663166383,12.18744258},
        {10, 0.282671351,0.828600748,0.28032548,0.285858785,0.479013486,0.034082164,0.267396264,0.822522538,0.042901646,0.895085994,12.33465658},
        {11, 0.156843052,0.719759164,0.475074955,0.947385853,0.011838121,0.243985916,0.829819438,0.612862884,0.487921743,0.247120291,12.17088117},
        {12, 0.147679004,0.281470556,0.7926828,0.297488361,0.183786883,0.580377747,0.368488977,0.631305034,0.12178893,0.136657147,8.241744149},
        {13, 0.403403064,0.335116682,0.872573382,0.260782666,0.396714253,0.786436477,0.413399317,0.596029712,0.323526125,0.067090049,12.4125086},
        {14, 0.708079367,0.500283397,0.609135085,0.119024376,0.700310268,0.681679814,0.292460546,0.95259563,0.997433321,0.830360991,13.44463297},
        {15, 0.684303994,0.410681191,0.375296193,0.751561535,0.045200104,0.905887082,0.595685325,0.863343193,0.088418415,0.835126547,17.06969605},
        {16, 0.43438082,0.921614288,0.137663246,0.799157725,0.239099094,0.495841968,0.353575854,0.044931759,0.558545255,0.892015973,18.35893902},
        {17, 0.158703307,0.450797481,0.723155187,0.500587938,0.67758648,0.969487696,0.289434525,0.451069546,0.254261766,0.790537471,10.59366368},
        {18, 0.307478459,0.578132021,0.565660546,0.714050525,0.885507559,0.167980351,0.738471541,0.026656348,0.388951219,0.654543053,15.82418009},
        {19, 0.483498593,0.750390968,0.171744567,0.266664969,0.575652432,0.512560669,0.886097502,0.969429122,0.666474066,0.2734212,17.9707457},
        {20, 0.37132879,0.067410596,0.781278015,0.373316648,0.86970056,0.482160526,0.555776038,0.841424559,0.268813121,0.906864402,9.241486956},
        {21, 0.349735535,0.073355563,0.459254385,0.694778677,0.140985765,0.828443158,0.104122603,0.891544915,0.376184177,0.66243085,7.537184524},
        {22, 0.482803373,0.331377767,0.241276455,0.68082836,0.717742214,0.83946393,0.613381255,0.966394825,0.381440641,0.445366083,18.90894618},
        {23, 0.574443107,0.278288709,0.604740052,0.332009078,0.708743829,0.157593272,0.879389639,0.530862033,0.938701723,0.101582451,13.05336731},
        {24, 0.664421183,0.10695719,0.314757321,0.978044941,0.261574706,0.488282947,0.250486237,0.946850093,0.1498622,0.87809005,11.68583753},
        {25, 0.956409589,0.868154978,0.740440517,0.7301389,0.799624589,0.57037518,0.286469946,0.508908961,0.982628877,0.995725357,21.60804326},
        {26, 0.507818034,0.461997679,0.708874161,0.322282554,0.843981752,0.282663863,0.992671088,0.851233321,0.25089675,0.37679836,15.38287582},
        {27, 0.235233852,0.351411218,0.407079886,0.919822263,0.597471303,0.5750678,0.137967654,0.758065658,0.735476567,0.076401882,13.47264467},
        {28, 0.997272065,0.870412299,0.940541234,0.362826118,0.993046696,0.307004042,0.173794001,0.8674832,0.99630015,0.187515785,15.50899044},
        {29, 0.869628417,0.298377229,0.27425927,0.742820345,0.706341796,0.943932317,0.682518168,0.958166083,0.189647703,0.798885552,20.17269345},
        {30, 0.002345785,0.921546892,0.019471369,0.236081665,0.029245509,0.340027284,0.893134872,0.103318879,0.63116939,0.452154162,8.590768158},
        {31, 0.42628289,0.213730893,0.885471542,0.369666686,0.215022875,0.313881034,0.733043283,0.554569148,0.607780207,0.717194637,12.61490461},
        {32, 0.322047413,0.075320056,0.760080495,0.838237212,0.224813253,0.831531399,0.497030261,0.513198931,0.810462245,0.911739836,11.92237626},
        {33, 0.863249556,0.83784,0.062934791,0.184742306,0.521089203,0.210791114,0.548630218,0.741511293,0.661052306,0.381943959,11.68304385},
        {34, 0.01659675,0.394799414,0.277635924,0.967646427,0.980857956,0.351885392,0.757714604,0.73080967,0.857013759,0.512207757,16.95320188},
        {35, 0.072823782,0.379456787,0.745140425,0.42166432,0.575709414,0.342798952,0.249495354,0.539758774,0.856004757,0.360480548,9.228252036},
        {36, 0.913283699,0.808467038,0.390493646,0.023806672,0.495696855,0.269522259,0.856594834,0.315328654,0.95729299,0.334248761,10.58151074},
        {37, 0.540405978,0.913593365,0.28454055,0.41602083,0.82118685,0.999150768,0.419214942,0.018880954,0.547712974,0.354400412,17.69243277},
        {38, 0.135257182,0.121678057,0.275682025,0.922117142,0.508369929,0.159489046,0.539097861,0.271480522,0.250426231,0.972261597,12.17136571},
        {39, 0.440992452,0.036792408,0.219670822,0.640996878,0.05225647,0.6145256,0.245669424,0.704139557,0.286413037,0.085577057,9.293144748},
        {40, 0.476914849,0.965174561,0.418015043,0.250729223,0.153023883,0.664060502,0.289522342,0.464351986,0.22422868,0.602803688,15.44747507},
        {41, 0.588627142,0.077517396,0.052713147,0.539817847,0.392872677,0.229387782,0.927403582,0.664915389,0.133537587,0.646049098,16.05075367},
        {42, 0.182000108,0.027146817,0.094238661,0.923621574,0.227869513,0.97786084,0.629719345,0.173224914,0.477674514,0.33532104,10.51851961},
        {43, 0.192376612,0.440393512,0.69845641,0.284916222,0.411180292,0.522768631,0.376584026,0.540895002,0.74605772,0.380468765,9.973271121},
        {44, 0.955611033,0.261554577,0.218077737,0.436131005,0.741992374,0.54437282,0.570333178,0.116889809,0.648602079,0.188455195,18.44120871},
        {45, 0.141009492,0.975514174,0.912652779,0.492706085,0.263415991,0.557583129,0.632280732,0.646068721,0.973042519,0.941576704,13.89643154},
        {46, 0.506091698,0.970689483,0.541750511,0.203599018,0.85490279,0.750508487,0.176676297,0.486344572,0.853758356,0.530875939,16.12129785},
        {47, 0.328973204,0.126191239,0.055689677,0.386807259,0.347342716,0.273686564,0.947631258,0.10437805,0.824797104,0.016835946,12.10599745},
        {48, 0.564987732,0.336204294,0.390347288,0.968119689,0.9257469,0.09889042,0.919960069,0.584977405,0.085039191,0.207979897,20.33602595},
        {49, 0.587501564,0.865695056,0.78527783,0.881485247,0.648862749,0.893418097,0.3679166,0.586922867,0.593774453,0.223834843,24.77916859},
        {50, 0.524343006,0.372528372,0.638486074,0.88604599,0.60566665,0.953760984,0.803571993,0.96766103,0.288292427,0.367117259,13.30165331},
        {51, 0.456562418,0.548918009,0.104590417,0.479031501,0.231369613,0.722086171,0.845254971,0.714729026,0.997034433,0.364800748,16.49806867},
        {52, 0.815958045,0.505886256,0.353882784,0.298369919,0.820261099,0.073977926,0.575007997,0.197595822,0.381478081,0.437694066,18.46042647},
        {53, 0.818605844,0.634054238,0.542548455,0.760476524,0.633037019,0.856880226,0.500350964,0.108421464,0.737154445,0.850316127,19.84209197},
        {54, 0.595210171,0.331042669,0.703831677,0.874472139,0.245488259,0.011717346,0.977857821,0.516532372,0.206695987,0.322002363,15.55710202},
        {55, 0.528110834,0.415436383,0.283091745,0.158120673,0.24581441,0.03463375,0.348480676,0.891515564,0.051860748,0.49822683,7.072678507},
        {56, 0.028848097,0.849635258,0.884924433,0.347639843,0.025354475,0.105762053,0.993824751,0.493608331,0.683788448,0.704439011,5.04324844},
        {57, 0.588195177,0.386559963,0.602498469,0.260456666,0.530493731,0.228895999,0.600914025,0.350885289,0.336197028,0.424058669,13.14608247},
        {58, 0.137634446,0.083649424,0.930851989,0.246973493,0.204087536,0.957353325,0.543628439,0.532716297,0.715522316,0.365349198,5.863153086},
        {59, 0.966377226,0.793348183,0.989688599,0.882935897,0.120988158,0.932847149,0.764878454,0.259808762,0.615261243,0.92385927,19.92815211},
        {60, 0.070589709,0.994951134,0.330122755,0.705847017,0.009873061,0.841854186,0.688325484,0.030978914,0.11259216,0.73326978,8.063577006},
        {61, 0.315387487,0.618311252,0.61479516,0.240851929,0.440898509,0.975775279,0.929570518,0.617262429,0.486840964,0.235933933,11.28026232},
        {62, 0.032006336,0.6290143,0.793805261,0.400310175,0.192553215,0.906575244,0.4711222,0.00255059,0.625895889,0.838245424,7.946662983},
        {63, 0.733046474,0.04262102,0.192965282,0.450776294,0.76941108,0.897819019,0.367479734,0.558357615,0.259671675,0.432356935,15.60096172},
        {64, 0.408071997,0.63788212,0.295627638,0.263622221,0.721922578,0.337853014,0.882186983,0.021888024,0.812100231,0.485864371,15.16616901},
        {65, 0.267460587,0.019014222,0.894664147,0.083460414,0.307566918,0.020856838,0.395207716,0.036800819,0.910844223,0.385108379,8.657427013},
        {66, 0.566541022,0.160737497,0.313118686,0.226557786,0.091776926,0.899233735,0.482488594,0.026339169,0.452523581,0.274780186,4.642892113},
        {67, 0.165064772,0.868490595,0.286505157,0.838732242,0.865171262,0.653181458,0.187876826,0.327142653,0.021770824,0.321944877,17.9688488},
        {68, 0.334354813,0.973616379,0.833202359,0.319095197,0.931382364,0.131171736,0.00148743,0.886953609,0.862517581,0.544863201,18.23975693},
        {69, 0.224635896,0.529320205,0.083727774,0.308345243,0.361146857,0.806627465,0.328671545,0.400068906,0.40610047,0.91623782,12.64698632},
        {70, 0.543542884,0.411493566,0.844769289,0.09139856,0.946995826,0.674921442,0.53074554,0.929704141,0.445856586,0.225903954,15.41478857},
        {71, 0.245377006,0.446631943,0.414979084,0.517780267,0.097611526,0.773068442,0.479916447,0.687477046,0.68052544,0.463257618,7.878246635},
        {72, 0.50275148,0.623811165,0.957062037,0.026241993,0.423293159,0.846871761,0.528710612,0.487560677,0.260477479,0.231447453,14.5775133},
        {73, 0.725132325,0.603635566,0.946723497,0.811180621,0.844618437,0.643784906,0.152263802,0.002093242,0.002196367,0.289793531,24.22261767},
        {74, 0.086413844,0.46564623,0.044540692,0.181915456,0.270813261,0.705702472,0.50420749,0.587236119,0.623321497,0.693602483,11.4445869},
        {75, 0.50398275,0.210356581,0.470479165,0.891356268,0.151267372,0.532578574,0.436280395,0.646197996,0.472388636,0.359690271,10.33170419},
        {76, 0.899087391,0.698448508,0.91794032,0.517107277,0.255290591,0.625106354,0.169649246,0.282858713,0.912959768,0.153443496,19.65706889},
        {77, 0.76512772,0.738857362,0.236363103,0.101751607,0.316590031,0.476769453,0.795381197,0.115285921,0.349850364,0.500022751,17.00430384},
        {78, 0.877989426,0.182347457,0.498416168,0.892941645,0.135971168,0.622823761,0.7806252,0.506685021,0.495380559,0.40199642,12.68371087},
        {79, 0.832526224,0.429295759,0.79263713,0.077267296,0.417234175,0.721998435,0.240334279,0.703822317,0.607809777,0.517697916,14.02801056},
        {80, 0.590258045,0.776369515,0.356900974,0.777431456,0.195004199,0.632799738,0.350841873,0.086119224,0.818779166,0.011232932,19.85895112},
        {81, 0.890165552,0.127152463,0.840932068,0.955743556,0.11876047,0.968722335,0.176022826,0.542892586,0.170878115,0.612483078,17.75564237},
        {82, 0.193154301,0.977182689,0.283310313,0.724068308,0.875577686,0.728636376,0.246232837,0.385674968,0.257221382,0.566079034,18.51962685},
        {83, 0.898716577,0.418302719,0.95488096,0.101694545,0.173170332,0.343039874,0.560600517,0.678976194,0.330542558,0.968796341,12.21969554},
        {84, 0.809484208,0.729277044,0.564948925,0.17435275,0.604612885,0.691645327,0.839499483,0.26839804,0.465498229,0.957159801,16.2688977},
        {85, 0.464050499,0.363405713,0.643871184,0.997419677,0.725528368,0.439720436,0.260037754,0.325241451,0.812336319,0.150326649,20.48808144},
        {86, 0.941147535,0.140271598,0.474286487,0.038289042,0.622523243,0.070597257,0.246940004,0.710143516,0.532271256,0.936707931,8.791097436},
        {87, 0.009827334,0.683871931,0.488719639,0.45019723,0.569157006,0.808997211,0.264812805,0.561194175,0.917173699,0.474904125,7.118678006},
        {88, 0.887039155,0.044591432,0.730774528,0.356209806,0.798213436,0.349069048,0.064803928,0.777073052,0.449992895,0.682659245,11.86563288},
        {89, 0.490228791,0.100235399,0.583154289,0.177078974,0.549333558,0.729898582,0.714070074,0.424329417,0.407217672,0.226108745,6.598005761},
        {90, 0.343055319,0.479704593,0.408445332,0.212046707,0.657740377,0.042809288,0.297293197,0.137307248,0.623952105,0.993321099,11.35139314},
        {91, 0.963280682,0.666926982,0.021490654,0.292733074,0.860190059,0.448214172,0.589307858,0.366063425,0.981536225,0.657794184,19.85721362},
        {92, 0.890625607,0.185100477,0.152053019,0.329115579,0.030745322,0.400252998,0.262765683,0.573219499,0.706608674,0.961116809,11.77705772},
        {93, 0.883531358,0.390586663,0.248460031,0.861782159,0.863090955,0.884526479,0.853979873,0.055254293,0.617407527,0.720417138,20.82225506},
        {94, 0.950800498,0.140324033,0.050535311,0.572460849,0.740585143,0.224096781,0.443758787,0.658462593,0.386386853,0.305692731,19.83141631},
        {95, 0.172085095,0.074816444,0.504397149,0.203881884,0.242147746,0.717438894,0.528412934,0.520985088,0.989587655,0.326656404,3.714881764},
        {96, 0.919418081,0.794069271,0.271464816,0.814732942,0.313248578,0.340532783,0.509325617,0.828695554,0.869731006,0.703064861,19.66070609},
        {97, 0.531805127,0.394815309,0.597517725,0.053447415,0.582150371,0.847851176,0.535311361,0.128975809,0.683657328,0.960365851,10.3236936},
        {98, 0.133453185,0.667156615,0.724602768,0.252394775,0.129571971,0.589379528,0.482767852,0.363807689,0.402507503,0.754105896,7.007025408},
        {99, 0.296174069,0.492582903,0.066418758,0.82359434,0.26778633,0.953213433,0.304718783,0.40725896,0.469972948,0.302188448,20.12964271},
        {100, 0.946281977,0.850392824,0.613847607,0.799446287,0.285696587,0.789778565,0.754188594,0.261962815,0.871076848,0.618084034,16.81136492}
    ],friedman1RECORD);

ML_Core.ToField(myData, myTrainDataNF);

myIndTrainDataNF := myTrainDataNF(number < 11); // Number is the field number

myDepTrainDataNF := PROJECT(myTrainDataNF(number = 11), TRANSFORM(RECORDOF(LEFT), SELF.number := 1, SELF := LEFT));

myLearnerR := LT.RegressionForest();
myModelR := myLearnerR.GetModel(myIndTrainDataNF, myDepTrainDataNF);
OUTPUT(myModelR);


// betas := DATASET([
//       {1, 1, 1, 0.196543},
//       {1, 2, 1, 7.735037},
//       {1, 3, 1, 6.791275},
//       {1, 4, 1, -0.510142},
//       {1, 5, 1, 9.458016},
//       {1, 6, 1, 4.961975},
//       {1, 7, 1, -0.026356},
//       {1, 8, 1, -0.362862},
//       {1, 9, 1, 0.121204},
//       {1, 10, 1, 0.065666},
//       {1, 11, 1, 0.240375}
//       ], Types.NumericField);

// Rsquared := 0.688785;

// adjRsquared := 0.685638;

// Total_SS := 27671.543823;

// Model_SS := 19059.742199;

// Error_SS := 8611.801625;

// Total_DF := 999.000000;